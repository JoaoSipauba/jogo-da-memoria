<html>

<head>
    <meta charset="UTF-8">
    <title>Jogo da Memoria</title>
    <link rel="stylesheet" href="src/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body>
    <header>
        <div id="titulo">
            <h1>Jogo da Memoria</h1>
        </div>
        <div id="toolbar">
            <a class="btn_sair" href="inicial.html"><button>Sair</button></a>
            <a class="btn_reiniciar">
                <button>reiniciar</button>
            </a>
        </div>
    </header>
    <div id="content">
        <script>
            $('document').ready(function () {
                if (localStorage.getItem("top1") === null) {
                    localStorage.setItem("top1", 800)
                }
                let q = ""
                let elementos = ['black', 'red', 'purple', 'blue', 'white', 'pink', 'orange', 'green'];
                let matriz = elementos.concat(elementos);
                let tamanho = matriz.length;
                for (let i = 0; i < tamanho; i++) {
                    let randomGet = Math.floor(Math.random() * matriz.length);
                    q += `<div id='${matriz[randomGet]}' class="imageContainer" style="background-color: ${matriz.splice(randomGet, 1)}">
                                <div class="front"></div>
                            </div>`
                    $('#content').html(q);
                }
                var t0 = performance.now();
                var click = []
                var achados = 0
                $('.btn_reiniciar').on('click', function () { document.location.reload() })
                $('.imageContainer').on('click', function (event) {
                    if ($(this).find('.back').attr('class') === 'back') {
                        return
                    }
                    let hidden = $(this).find('.front')
                    hidden.removeClass('front').addClass('back')
                    click.push(
                        {
                            nome: $(this).attr('id'),
                            obj: $(this)
                        }
                    )
                    if (click.length === 2) {
                        if (click[0].nome === click[1].nome) {
                            console.log('iguais');
                            achados = achados + 1;
                            console.log(achados);
                            if (achados === 8) {
                                var t1 = performance.now();
                                var tempo = ((t1 - t0) / 1000).toFixed(2);
                                var top1 = localStorage.getItem("top1")
                                var top2 = localStorage.getItem("top2")
                                var top3 = localStorage.getItem("top3")
                                alert(`vocÃª ganhou! em ${tempo} segundos.`);
                                if (tempo < top1) {
                                    localStorage.setItem('top1', tempo);
                                }
                            }
                        }
                        else {
                            for (const item of click) {
                                setTimeout(function () {
                                    item.obj.find('.back').removeClass('back').addClass('front');
                                }, 500)
                            }
                        }
                        click = []
                    }
                })
            });
        </script>
    </div>
</body>

</html>